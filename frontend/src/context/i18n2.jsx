import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';

const LanguageContext = createContext({ lang: 'en', t: (k) => k, setLang: () => {} });

const DICT = {
  en: {
    playNow: 'Play Now',
    howToPlay: 'How to Play',
    about: 'About',
    gameSettings: 'Game Settings',
    gameConfiguration: 'Game Configuration',
    mode: 'Mode',
    onePlayer: '1 Player (vs AI)',
    onePlayerShort: '1 PLAYER',
    vsAI: 'vs AI',
    twoPlayers: '2 Players (same device)',
    twoPlayersShort: '2 PLAYERS',
    sameDevice: 'same device',
    gameLevel: 'Game Level',
    level: 'Level',
    teamColors: 'Team Colors',
    yourTeam: 'Your Team',
    you: 'You',
    ai: 'AI',
    start: 'Start Game',
    startShort: 'Start',
    advancedConfigurations: 'Advanced Configurations',
    leftYouStart: 'Left (You start)',
    rightAIStarts: 'Right (AI starts)',
    timer: 'Timer',
    turnTimer: 'Turn Timer',
    optional: '(Optional)',
    enabled: 'Enabled',
    disabled: 'Disabled',
    minutes: 'minutes',
    seconds: 'seconds',
    difficulty: 'Difficulty',
    easy: 'Easy',
    medium: 'Medium',
    hard: 'Hard',
    left: 'Left',
    right: 'Right',
    youStart: 'You start',
    aiStarts: 'AI starts',
    player2: 'Player 2',
    maxTurns: 'Max Turns',
    maxTurnsHint: 'When enabled, game draws at this turn.',
    colorSelectedByOpponent: 'Color already selected by opponent',
    colorSelectedByPlayer: 'Color already selected by player',
    turn: 'Turn',
    homeConfirmTitle: 'Leave Game?',
    homeConfirmText: "You're about to leave the game. Are you sure?",
    cancel: 'Cancel',
    leave: 'Leave',
    save: 'Save',
    close: 'Close',
    helpTitle: 'Help',
    helpText: 'Select a chip or the ball; click highlighted cells to move or kick. Forced kicks apply when adjacent and ball is not neutral.',
    configTitle: 'Game Settings',
    landingTagline: 'A unique strategy game that combines the excitement of football with deep tactical decision-making and smart positioning.',
    pitchGrid: 'Pitch Grid',
    difficultyLevels: 'Difficulty Levels',
    realTime: 'Real-time',
    turnFeedback: 'Turn Feedback',
    learnMoreThesis: 'Learn about the thesis and research context',
    ruleBook: 'Rule Book',
    ruleObjectiveBanner: 'Objective: Score goals to win!',
    ruleDetails: 'Details',
    ruleBasicsLabel: 'Basics',
    ruleBasicsTitle: 'Objective',
    ruleBasicsLead: 'Score goals to win. Control space, pass smartly, and shoot through the central goal area.',
    ruleBasicsItems: [
      'Pitch is 15 rows \u00D7 11 columns. Middle band contains both goal mouths.',
      'Teams: LEFT vs RIGHT. Turns alternate by team.',
      'On your turn you either move a chip or kick the ball (if in possession).',
      'Game may end on a goal or by tournament termination rules.'
    ],
    ruleMoveLabel: 'Move',
    ruleMoveTitle: 'How to Move',
    ruleMoveLead: 'Select one of your chips and move to an adjacent valid cell.',
    ruleMoveItems: [
      'Legal destinations are highlighted; sideline traps are out of play.',
      'You cannot move into outside cells beyond the cream boundary.',
      'Moving onto the ball gains possession unless a forced kick applies.'
    ],
    ruleKickLabel: 'Kick',
    ruleKickTitle: 'Kicking & Passing',
    ruleKickLead: 'If your chip holds the ball, kick to any highlighted reachable square.',
    ruleKickItems: [
      'Kicks follow straight lines until blocked; server validates legality.',
      'Forced kicks may apply when adjacent and ball is not neutral.',
      'Create angles to open a shooting lane toward the central goal boxes.'
    ],
    ruleScoreLabel: 'Scoring',
    ruleScoreTitle: 'How to Score',
    ruleScoreLead: 'Shoot the ball into the opponent\'s goal band (middle columns 3\u20137).',
    ruleScoreItems: [
      'Left team scores at top goal; Right team scores at bottom goal.',
      'Only the central five columns count as the goal mouth.',
      'After a score, play resets per tournament system rules.'
    ],
    configureMatch: 'Configure a Match',
    aboutTitle: 'About This Thesis',
    researchContext: 'Research Context',
    researchBlurb: 'This project evaluates competitive AI agents on a structured, turn-based football environment (Mastergoal), comparing Minimax, MCTS, and heuristic-driven strategies across different team sizes. The web interface provides a controlled setting to reproduce benchmark conditions and visualize agent behavior.',
    credits: 'Credits',
    thesisAuthor: 'Thesis Author: Amparo Oliver',
    advisors: 'Advisor(s): PhD. Luca Cernuzzi',
    thanksCreator: 'Special thanks to the creator of the game, Alberto Bogliaccini',
    repositories: 'Repositories',
    webFrontend: 'Web Frontend',
    flaskBackend: 'Flask Backend',
    tournamentSystem: 'Tournament System',
    contact: 'Contact',
    email: 'Email',
    returnHome: 'Return to Home',
    drawByTurnsExplain: 'Draw by turn limit. Nobody reached 2 goals (win condition).',
    drawExplain: 'Draw. Nobody reached 2 goals (win condition).',
    neutralTileTitle: 'Neutral ball',
    neutralTileBody: "The ball is neutral: you can't kick it. Move a majority of your chips around it to take control.",
    specialTileTitle: 'Extra turn!',
    specialTileBody: 'You placed the ball on a special tile — your team plays again.',
  },
  es: {
    playNow: 'Jugar Ahora',
    howToPlay: 'C\u00F3mo Jugar',
    about: 'Acerca de',
    gameSettings: 'Configuraci\u00F3n del Juego',
    gameConfiguration: 'Configuraci\u00F3n del Juego',
    mode: 'Modo',
    onePlayer: '1 Jugador (vs IA)',
    onePlayerShort: '1 JUGADOR',
    vsAI: 'vs IA',
    twoPlayers: '2 Jugadores (mismo dispositivo)',
    twoPlayersShort: '2 JUGADORES',
    sameDevice: 'mismo dispositivo',
    gameLevel: 'Nivel de Juego',
    level: 'Nivel',
    teamColors: 'Colores del Equipo',
    yourTeam: 'Tu Equipo',
    you: 'T\u00FA',
    ai: 'IA',
    start: 'Comenzar Juego',
    startShort: 'Comenzar',
    advancedConfigurations: 'Configuraciones Avanzadas',
    leftYouStart: 'Izquierda (T\u00FA empiezas)',
    rightAIStarts: 'Derecha (IA empieza)',
    timer: 'Temporizador',
    turnTimer: 'Temporizador por Turno',
    optional: '(Opcional)',
    enabled: 'Activado',
    disabled: 'Desactivado',
    minutes: 'minutos',
    seconds: 'segundos',
    difficulty: 'Dificultad',
    easy: 'F\u00E1cil',
    medium: 'Media',
    hard: 'Dif\u00EDcil',
    left: 'Izquierda',
    right: 'Derecha',
    youStart: 'T\u00FA empiezas',
    aiStarts: 'IA empieza',
    player2: 'Jugador 2',
    maxTurns: 'L\u00EDmite de Turnos',
    maxTurnsHint: 'Si est\u00E1 activado, el juego termina en empate en ese turno.',
    colorSelectedByOpponent: 'Color ya elegido por el rival',
    colorSelectedByPlayer: 'Color ya elegido por el jugador',
    turn: 'Turno',
    homeConfirmTitle: '\u00BFSalir del Juego?',
    homeConfirmText: 'Est\u00E1s a punto de salir del juego. \u00BfEst\u00E1s seguro?',
    cancel: 'Cancelar',
    leave: 'Salir',
    save: 'Guardar',
    close: 'Cerrar',
    helpTitle: 'Ayuda',
    helpText: 'Selecciona una ficha o la pelota; haz clic en las casillas resaltadas para mover o patear. Hay pateo forzado cuando est\u00E1s adyacente y la pelota no es neutral.',
    configTitle: 'Configuraci\u00F3n del Juego',
    landingTagline: 'Un juego de estrategia que combina la emoci\u00F3n del f\u00FAtbol con decisiones t\u00E1cticas profundas y posicionamiento inteligente.',
    pitchGrid: 'Rejilla del Campo',
    difficultyLevels: 'Niveles de Dificultad',
    realTime: 'En tiempo real',
    turnFeedback: 'Indicador de Turno',
    learnMoreThesis: 'Conoce la tesis y el contexto de investigaci\u00F3n',
    ruleBook: 'Libro de Reglas',
    ruleObjectiveBanner: 'Objetivo: \u00A1Anota goles para ganar!',
    ruleDetails: 'Detalles',
    ruleBasicsLabel: 'B\u00E1sicos',
    ruleBasicsTitle: 'Objetivo',
    ruleBasicsLead: 'Anota goles para ganar. Controla espacios, pasa con inteligencia y dispara hacia la zona central del arco.',
    ruleBasicsItems: [
      'El campo es de 15 filas \u00D7 11 columnas. La franja central contiene las porter\u00EDas.',
      'Equipos: IZQUIERDA vs DERECHA. Los turnos alternan por equipo.',
      'En tu turno mueves una ficha o pateas la pelota (si la posees).',
      'El juego termina con un gol o por reglas del torneo.'
    ],
    ruleMoveLabel: 'Movimiento',
    ruleMoveTitle: 'C\u00F3mo Mover',
    ruleMoveLead: 'Selecciona una ficha y mu\u00E9vela a una casilla v\u00E1lida adyacente.',
    ruleMoveItems: [
      'Los destinos legales se resaltan; las bandas exteriores est\u00E1n fuera de juego.',
      'No puedes entrar en casillas exteriores m\u00E1s all\u00E1 del borde crema.',
      'Al caer sobre la pelota tomas posesi\u00F3n salvo si aplica pateo forzado.'
    ],
    ruleKickLabel: 'Pateo',
    ruleKickTitle: 'Patear y Pasar',
    ruleKickLead: 'Si tu ficha tiene la pelota, patea a cualquier casilla alcanzable resaltada.',
    ruleKickItems: [
      'Los tiros siguen l\u00EDneas rectas hasta chocar; el servidor valida la legalidad.',
      'Puede haber pateo forzado al estar adyacente y la pelota no ser neutral.',
      'Crea \u00E1ngulos para abrir l\u00EDnea de disparo hacia el arco central.'
    ],
    ruleScoreLabel: 'Anotar',
    ruleScoreTitle: 'C\u00F3mo Anotar',
    ruleScoreLead: 'Dispara la pelota dentro de la banda de gol rival (columnas 3\u20137).',
    ruleScoreItems: [
      'El equipo IZQUIERDA anota en el arco superior; DERECHA en el inferior.',
      'Solo cuentan las cinco columnas centrales como arco.',
      'Tras un gol, el juego se reinicia seg\u00FAn el torneo.'
    ],
    configureMatch: 'Configurar una Partida',
    aboutTitle: 'Acerca de esta Tesis',
    researchContext: 'Contexto de Investigaci\u00F3n',
    researchBlurb: 'Este proyecto eval\u00FAa agentes de IA competitivos en un entorno de f\u00FAtbol por turnos (Mastergoal), comparando Minimax, MCTS y estrategias heur\u00EDsticas en distintos tama\u00F1os de equipo. La web permite reproducir condiciones de prueba y visualizar el comportamiento de los agentes.',
    credits: 'Cr\u00E9ditos',
    thesisAuthor: 'Autora de la tesis: Amparo Oliver',
    advisors: 'Director(es): PhD. Luca Cernuzzi',
    thanksCreator: 'Agradecimientos al creador del juego, Alberto Bogliaccini',
    repositories: 'Repositorios',
    webFrontend: 'Frontend Web',
    flaskBackend: 'Backend Flask',
    tournamentSystem: 'Sistema de Torneo',
    contact: 'Contacto',
    email: 'Correo',
    returnHome: 'Volver al Inicio',
    drawByTurnsExplain: 'Empate por límite de turnos. Nadie alcanzó 2 goles (condición para ganar).',
    drawExplain: 'Empate. Nadie alcanzó 2 goles (condición para ganar).',
    neutralTileTitle: 'Pelota neutral',
    neutralTileBody: 'La pelota está neutral: no se puede patear. Mueve una mayoría de tus fichas alrededor para tomar el control.',
    specialTileTitle: '¡Turno extra!',
    specialTileBody: 'Ubicaste la pelota en una casilla especial — tu equipo juega de nuevo.',
  }
};

export const LanguageProvider = ({ children }) => {
  const [lang, setLang] = useState(() => localStorage.getItem('lang') || 'en');
  useEffect(() => { try { localStorage.setItem('lang', lang); } catch {} }, [lang]);
  const t = useMemo(() => (key) => (DICT[lang] && DICT[lang][key]) ?? (DICT['en'][key] ?? key), [lang]);
  return (
    <LanguageContext.Provider value={{ lang, setLang, t }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useI18n = () => useContext(LanguageContext);
